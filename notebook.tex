
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Xylem flux - Dumux}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{\texorpdfstring{Water flux within the root - Numerical
solutions in
DuMu\({}^x\)}{Water flux within the root - Numerical solutions in DuMu\{\}\^{}x}}\label{water-flux-within-the-root---numerical-solutions-in-dumux}

\emph{by Daniel Leitner, Andrea Schnepf, Timo Koch}

    In the following we will give some hints how to solve Benchmark 1 \& 2,
using \href{www.dumux.org}{DuMu\({}^x\)}. The source code of the
following benchmarking examples is available on
\href{https://github.com/Plant-Root-Soil-Interactions-Modelling/dumux-rosi.git}{Github},
in the folder dumux-rosi/rosi\_benchmarking/rootsystem/.

    \subsection{General remarks}\label{general-remarks}

    In DuMu\({}^x\) we base the problem on the one-phase porous medium model
(\texttt{porousmediumflow/1p/model.hh}) meaning there is one fluid phase
(water) inside a porous medium (root). Hence, the root is modeled as a
porous medium, where the root xylem is the pore space filled with water
and all other root components constitute the solid matrix.

Next we have to do some C++ programming specifying the exact benchmark
scenario. This is done by calculating the permeability from our
parameters (in the \emph{spatial parameters} class \(\rightarrow\)
\texttt{RootsParams} in \texttt{rootsparams.hh}), and by defining the
boundary conditions and the source term (in the \emph{problem} class
\(\rightarrow\) \texttt{RootsProblem} in \texttt{rootsproblem.hh}).

    In the spatial parameter class (\texttt{RootsParams}) we set the
permeability by extending the class \texttt{FVSpatialParamsOneP} (finite
volume spatial parameters for one-phase models) and overwriting the
following member function

    \begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Scalar extrusionFactor(}\AttributeTok{const}\NormalTok{ Element& element,}
                       \AttributeTok{const}\NormalTok{ SubControlVolume& scv,}
                       \AttributeTok{const}\NormalTok{ ElementSolution& elemSol) }\AttributeTok{const}
\NormalTok{\{}
    \AttributeTok{const}\NormalTok{ Scalar r = spatialParams().radius(scv); }\CommentTok{// root radius (m)}
    \ControlFlowTok{return}\NormalTok{ M_PI * r * r;}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

    The function allows to specify the intrinsic permeability (\(m^2\)). We
convert the root axial conductivity (\$\frac{m^5 s}{kg} =
\frac{m^4}{Pa \ s}
\() to the intrinsic permeability by multiplication with the dynamic viscosity (\)Pa
~s\$) and division by the cross-section area \(\pi r^2\) (\(m^2\)). The
intrinsic permeability is a resistance coefficient that is only
dependent on the root xylem and not the properties of the fluid (water).

    Boundary conditions and the source term are implemented in the problem
class by overwriting member functions in the class \texttt{RootsProblem}
which is extended from \texttt{PorousMediumFlowProblem}.

First, the boundary conditions are defined by choosing the boundary
condition type, which is either Neumann or Dirichlet. In the next step
the Neumann flux, and the Dirichlet value for the boundaries are
defined.

    \begin{Shaded}
\begin{Highlighting}[]
\NormalTok{BoundaryTypes boundaryTypesAtPos(}\AttributeTok{const}\NormalTok{ GlobalPosition &pos) }\AttributeTok{const}
\NormalTok{\{}
\NormalTok{    BoundaryTypes bcTypes; }\CommentTok{// create a boundary types object}
\NormalTok{    bcTypes.setAllNeumann(); }\CommentTok{// default to Neumann}

    \CommentTok{// set Dirichlet boundaries at the root collar}
    \ControlFlowTok{if}\NormalTok{ (}\VariableTok{onUpperBoundary_}\NormalTok{(pos))}
\NormalTok{        bcTypes.setAllDirichlet();}

    \CommentTok{// for all other (i.e. root tips) set either Dirichlet or Neumann depending on the scenario}
    \ControlFlowTok{else}
\NormalTok{    \{ }
        \ControlFlowTok{if}\NormalTok{ (}\VariableTok{scenario_}\NormalTok{==}\DecValTok{1}\NormalTok{)}
\NormalTok{            bcTypes.setAllDirichlet();}
        \ControlFlowTok{else}
\NormalTok{            bcTypes.setAllNeumann();}
\NormalTok{    \}}
    
    \ControlFlowTok{return}\NormalTok{ bcTypes;}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

    For the collar we pick always a Dirichlet boundary condition (i.e we set
the pressure). For the root tips we set a pressure only for Scenario 1,
for other scenarios we assume a no-flux boundary condition.

Next we specify the actual values for the Dirichlet and Neumann boundary
conditions:

    \begin{Shaded}
\begin{Highlighting}[]
\NormalTok{PrimaryVariables dirichletAtPos(}\AttributeTok{const}\NormalTok{ GlobalPosition &pos) }\AttributeTok{const}
\NormalTok{\{}
\NormalTok{    PrimaryVariables priVar(}\FloatTok{0.0}\NormalTok{); }\CommentTok{// create a primary variable object}
    
    \CommentTok{// root collar}
    \ControlFlowTok{if}\NormalTok{ (}\VariableTok{onUpperBoundary_}\NormalTok{(pos)) }
\NormalTok{        priVar = }\VariableTok{p0_}\NormalTok{;}
        
    \CommentTok{// for all other (i.e. root tips)}
    \ControlFlowTok{else} 
\NormalTok{        priVar = }\VariableTok{pL_}\NormalTok{;}

    \ControlFlowTok{return}\NormalTok{ priVar;}
\NormalTok{\}   }

\NormalTok{ResidualVector neumann(}\AttributeTok{const}\NormalTok{ Element& element,}
                       \AttributeTok{const}\NormalTok{ FVElementGeometry& fvGeometry,}
                       \AttributeTok{const}\NormalTok{ ElementVolumeVariables& elemVolVars,}
                       \AttributeTok{const}\NormalTok{ SubControlVolumeFace& scvf) }\AttributeTok{const}
\NormalTok{\{}
    \ControlFlowTok{return}\NormalTok{ ResidualVector(}\DecValTok{0}\NormalTok{.);}
\NormalTok{\}  }
    
\end{Highlighting}
\end{Shaded}

    Finally, we need to define the uptake by the root as a source term in
the model, following Eqn 3 from \href{Xylem\%20flux.ipynb}{Xylem flux}.

    \begin{Shaded}
\begin{Highlighting}[]
\CommentTok{//! return the mass source in units kg/(s m^3)}
\NormalTok{ResidualVector source(}\AttributeTok{const}\NormalTok{ Element &element,}
                      \AttributeTok{const}\NormalTok{ FVElementGeometry& fvGeometry,}
                      \AttributeTok{const}\NormalTok{ ElementVolumeVariables& elemVolVars,}
                      \AttributeTok{const}\NormalTok{ SubControlVolume &scv) }\AttributeTok{const}
\NormalTok{\{}
\NormalTok{    ResidualVector values; }\CommentTok{// create a residual vector (size 1 because we solve only one equation)}
    \AttributeTok{const} \KeywordTok{auto}\NormalTok{& params = }\KeywordTok{this}\NormalTok{->spatialParams();}
    \AttributeTok{const}\NormalTok{ Scalar l = scv.volume(); }\CommentTok{// length of element as the control volume is one-dimensional (m)}
    \AttributeTok{const}\NormalTok{ Scalar r = params.radius(scv); }\CommentTok{// root radius (m)}
    \AttributeTok{const}\NormalTok{ Scalar kr = params.radialConductivity(scv); }\CommentTok{//  radial conductivity (m^2 s / kg)}
    \AttributeTok{const}\NormalTok{ Scalar phx = elemVolVars[scv].pressure(); }\CommentTok{// xylem water pressure kg/m/s^2 or Pa}
    \AttributeTok{const}\NormalTok{ Scalar phs = }\VariableTok{soilP_}\NormalTok{; }\CommentTok{// soil water pressure kg/m/s^2 or Pa}

\NormalTok{    values = }\VariableTok{rho_}\NormalTok{*kr * }\DecValTok{2}\NormalTok{*r*M_PI*l * (phs - phx); }\CommentTok{// kg/s}
\NormalTok{    values /= (r*r*M_PI)*l; }\CommentTok{// divide by volume because Dumux expects volume specific source rates (kg/s/m^3)}
    \ControlFlowTok{return}\NormalTok{ values;}
\NormalTok{\}   }
\end{Highlighting}
\end{Shaded}

    As a last thing, which is specific to DuMu\({}^x\), we have to set the
domain extrusion factor. DuMu\({}^x\) always thinks in terms of
three-dimensional domains and units. A one-dimensional grid is actually
thought of representing a tube or channel with a cross-section area
equal to \(1\). (A two-dimensional grid would be interpreted as a
three-dimensional domain with depth \(1\)). For the root, we set the
extrusion factor to the actual cross-section area of the root, i.e.
\(A = \pi r^2\):

    \begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Scalar extrusionFactorAtPos(}\AttributeTok{const}\NormalTok{ GlobalPosition& globalPos)}
\NormalTok{\{}
    \AttributeTok{const}\NormalTok{ Scalar r = params.radius(SubControlVolume()); }\CommentTok{// root radius (m)}
    \ControlFlowTok{return}\NormalTok{ M_PI * r * r;}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

    Now the model is implemented in Dumux, and after compilation we can use
it to solve Benchmark 1 \& 2

    \subsubsection{Benchmark 1}\label{benchmark-1}

    First we create the geometry by writing a DGF (Dune Grid file) using the
following Python function

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        
        \PY{k}{def} \PY{n+nf}{createDGF\PYZus{}1Droots}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{n}{nodes}\PY{p}{,} \PY{n}{seg}\PY{p}{,} \PY{n}{params} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{:}        
            \PY{n}{file} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{w}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} write file }
            
            \PY{n}{nop} \PY{o}{=} \PY{n}{params}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{c+c1}{\PYZsh{} number of parameters    }
            \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DGF}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} 
            \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Vertex}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{nodes}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:g\PYZcb{}}\PY{l+s+s1}{ }\PY{l+s+si}{\PYZob{}:g\PYZcb{}}\PY{l+s+s1}{ }\PY{l+s+si}{\PYZob{}:g\PYZcb{}}\PY{l+s+s1}{ }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{nodes}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{nodes}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{nodes}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                     
            \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
            \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Simplex}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;} 
            \PY{k}{if} \PY{n}{nop}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{:}
                \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{parameters }\PY{l+s+si}{\PYZob{}:d\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{nop}\PY{p}{)}\PY{p}{)} 
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{seg}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:g\PYZcb{}}\PY{l+s+s1}{ }\PY{l+s+si}{\PYZob{}:g\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{seg}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{seg}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{nop}\PY{p}{)}\PY{p}{:} 
                    \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+si}{\PYZob{}:g\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{params}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}        
                \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                
            \PY{c+c1}{\PYZsh{} not used...        }
            \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{BOUNDARYSEGMENTS}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{2 0}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}          
            \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3 }\PY{l+s+si}{\PYZob{}:g\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{seg}\PY{p}{)}\PY{p}{)}\PY{p}{)} 
            \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{BOUNDARYDOMAIN}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{default 1}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{file}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            
            \PY{n}{file}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)} 
\end{Verbatim}


    Optionally, we can attach parameters to the segments. This will be used
in Benchmark 2.

    We call the function to create a straight single root

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:}     \PY{n}{nnz} \PY{o}{=} \PY{l+m+mi}{100} \PY{c+c1}{\PYZsh{} resolution}
            \PY{n}{L} \PY{o}{=} \PY{l+m+mf}{0.5} \PY{c+c1}{\PYZsh{} length of single straight root (m)}
            
            \PY{n}{nodes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{nnz}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} create grid}
            \PY{n}{seg} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{p}{(}\PY{n}{nnz}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)} 
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{nnz}\PY{p}{)}\PY{p}{:}
                \PY{n}{seg}\PY{p}{[}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
                \PY{n}{seg}\PY{p}{[}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{i}
                \PY{n}{nodes}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.}\PY{p}{,}\PY{l+m+mf}{0.}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{n}{i}\PY{o}{*}\PY{n}{L}\PY{o}{/}\PY{p}{(}\PY{n}{nnz}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}  
         
            \PY{n}{createDGF\PYZus{}1Droots}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{singleroot.dgf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{nodes}\PY{p}{,} \PY{n}{seg}\PY{p}{)}
\end{Verbatim}


    The rest of the parameters of Benchmark 1, we move to the Dumux input
file. These parameters are parsed by Dumux, and can be easily retrieved
within the C++ code. The input file singleroot.input is given by:

    \begin{verbatim}
[Grid]
File = singleroot.dgf

[Parameter]
SoilP = -200 # cm pressure head
Kr = 2.e-9  # radial conductivity (m^2 s / kg) 
Kz = 5.e-13 # axial conductivity (m^5 s / kg)
Radius = 2.e-3 # radius (m)  
P0 = -1000 # cm pressure head
PL = -500 # cm pressure head
Scenario = 1 # 1 or 2  

[Problem]
Name = roots # name passed to the output routines
EnableGravity = true # optionally turn on/off gravity
\end{verbatim}

    The file holds the following information sorted in three parameter
groups: * {[}Grid{]} is the geometry file we just created, and *
{[}Parameter{]} all the parameter we supply for Benchmark 1, Scenario 1
and 2 * {[}Prolbem{]} the name of our problem, and we want to enable
gravitation

    With this two files (\texttt{.dgf}, and \texttt{.input}) we can run
DUMUX for both scenarios (if you insert the correct path):

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{n}{path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/daniel/workspace/DUMUX/dumux\PYZhy{}rosi/build\PYZhy{}cmake/rosi\PYZus{}benchmarking/rootsystem/}\PY{l+s+s2}{\PYZdq{}} 
        \PY{n}{wd} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{getcwd}\PY{p}{(}\PY{p}{)}
        \PY{n}{os}\PY{o}{.}\PY{n}{chdir}\PY{p}{(}\PY{n}{path}\PY{p}{)}
        \PY{n}{os}\PY{o}{.}\PY{n}{system}\PY{p}{(} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./rootsystem input/singleroot\PYZus{}S1.input}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{os}\PY{o}{.}\PY{n}{system}\PY{p}{(} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./rootsystem input/singleroot\PYZus{}S2.input}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{os}\PY{o}{.}\PY{n}{system}\PY{p}{(} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./rootsystem input/singleroot\PYZus{}h.input}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} additionally, a horizontal root}
        \PY{n}{os}\PY{o}{.}\PY{n}{chdir}\PY{p}{(}\PY{n}{wd}\PY{p}{)}
\end{Verbatim}


    In order to look at the results in Python, VTK is needed (to open the
Dumux VTP output). The following methods help to plot the results:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k+kn}{import} \PY{n+nn}{vtk}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        
        \PY{k}{def} \PY{n+nf}{read\PYZus{}polydata}\PY{p}{(}\PY{n}{name}\PY{p}{)}\PY{p}{:}
            \PY{n}{reader} \PY{o}{=} \PY{n}{vtk}\PY{o}{.}\PY{n}{vtkXMLPolyDataReader}\PY{p}{(}\PY{p}{)}
            \PY{n}{reader}\PY{o}{.}\PY{n}{SetFileName}\PY{p}{(}\PY{n}{name}\PY{p}{)}
            \PY{n}{reader}\PY{o}{.}\PY{n}{Update}\PY{p}{(}\PY{p}{)}   
            \PY{n}{polydata} \PY{o}{=} \PY{n}{reader}\PY{o}{.}\PY{n}{GetOutput}\PY{p}{(}\PY{p}{)} 
            \PY{k}{return} \PY{n}{polydata}
        
        \PY{k}{def} \PY{n+nf}{read1D\PYZus{}vtp\PYZus{}data}\PY{p}{(}\PY{n}{name}\PY{p}{,} \PY{n}{cell} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
            \PY{n}{polydata} \PY{o}{=} \PY{n}{read\PYZus{}polydata}\PY{p}{(}\PY{n}{name}\PY{p}{)}     
            \PY{k}{if} \PY{n}{cell}\PY{p}{:} 
                \PY{n}{data} \PY{o}{=} \PY{n}{polydata}\PY{o}{.}\PY{n}{GetCellData}\PY{p}{(}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{data} \PY{o}{=} \PY{n}{polydata}\PY{o}{.}\PY{n}{GetPointData}\PY{p}{(}\PY{p}{)}        
            \PY{n}{nocd} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{GetNumberOfArrays}\PY{p}{(}\PY{p}{)}
            \PY{n}{p} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{GetArray}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{} pressure   }
            \PY{n}{noa} \PY{o}{=} \PY{n}{p}\PY{o}{.}\PY{n}{GetNumberOfTuples}\PY{p}{(}\PY{p}{)}    
            \PY{n}{p\PYZus{}} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{noa}\PY{p}{,}\PY{p}{)}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{noa}\PY{p}{)}\PY{p}{:}    
                \PY{n}{d} \PY{o}{=} \PY{n}{p}\PY{o}{.}\PY{n}{GetTuple}\PY{p}{(}\PY{n}{i}\PY{p}{)}
                \PY{n}{p\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{d}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}            
            \PY{k}{return} \PY{n}{p\PYZus{}}
\end{Verbatim}


    Now we can read the DuMu\({}^x\) output convert units to cm pressure
head

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        
        \PY{n}{g} \PY{o}{=} \PY{l+m+mf}{9.81} \PY{c+c1}{\PYZsh{} gravitational acceleration (m/s\PYZca{}2)   }
        \PY{n}{rho} \PY{o}{=} \PY{l+m+mf}{1.e3} \PY{c+c1}{\PYZsh{} density of water (kg/m\PYZca{}3)      }
        \PY{n}{ref} \PY{o}{=} \PY{l+m+mf}{1.e5} \PY{c+c1}{\PYZsh{} reference pressure (Pa)}
        
        \PY{k}{def} \PY{n+nf}{toPa}\PY{p}{(}\PY{n}{ph}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{} cm pressure head to Pascal (kg/ (m s\PYZca{}2))}
            \PY{k}{return} \PY{n}{ref} \PY{o}{+} \PY{n}{ph}\PY{o}{/}\PY{l+m+mf}{100.} \PY{o}{*} \PY{n}{rho} \PY{o}{*} \PY{n}{g}
        
        \PY{k}{def} \PY{n+nf}{toHead}\PY{p}{(}\PY{n}{pa}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{} Pascal (kg/ (m s\PYZca{}2)) to cm pressure head}
            \PY{k}{return} \PY{p}{(}\PY{n}{pa}\PY{o}{\PYZhy{}}\PY{n}{ref}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{100} \PY{o}{/} \PY{n}{rho} \PY{o}{/} \PY{n}{g}
        
        \PY{n}{h1\PYZus{}} \PY{o}{=} \PY{n}{toHead}\PY{p}{(}\PY{n}{read1D\PYZus{}vtp\PYZus{}data}\PY{p}{(}\PY{n}{path}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{singleroot\PYZus{}S1\PYZhy{}00001.vtp}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{k+kc}{False}\PY{p}{)}\PY{p}{)}
        \PY{n}{h2\PYZus{}} \PY{o}{=} \PY{n}{toHead}\PY{p}{(}\PY{n}{read1D\PYZus{}vtp\PYZus{}data}\PY{p}{(}\PY{n}{path}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{singleroot\PYZus{}S2\PYZhy{}00001.vtp}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{k+kc}{False}\PY{p}{)}\PY{p}{)}
        \PY{n}{z\PYZus{}} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{h1\PYZus{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    and plot the data with the analytical solution

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k+kn}{from} \PY{n+nn}{math} \PY{k}{import} \PY{o}{*}
        \PY{c+c1}{\PYZsh{} Parameters}
        \PY{n}{L} \PY{o}{=} \PY{l+m+mf}{0.5}                \PY{c+c1}{\PYZsh{} length of single straight root (m)}
        \PY{n}{a} \PY{o}{=} \PY{l+m+mf}{2.e\PYZhy{}3}              \PY{c+c1}{\PYZsh{} radius (m)}
        \PY{n}{kz} \PY{o}{=} \PY{l+m+mf}{5.e\PYZhy{}13}            \PY{c+c1}{\PYZsh{} axial conductivity (m\PYZca{}5 s / kg) (mal rho ergibt die alten einheiten)}
        \PY{n}{kr} \PY{o}{=} \PY{l+m+mf}{2.e\PYZhy{}9}             \PY{c+c1}{\PYZsh{} radial conductivity per root type (m\PYZca{}2 s / kg) }
        \PY{n}{p\PYZus{}s} \PY{o}{=} \PY{n}{toPa}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{200}\PY{p}{)}       \PY{c+c1}{\PYZsh{} static soil pressure (cm) }
        \PY{n}{p0} \PY{o}{=} \PY{n}{toPa}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1000}\PY{p}{)}       \PY{c+c1}{\PYZsh{} dircichlet bc at top}
        \PY{n}{pL} \PY{o}{=} \PY{n}{toPa}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{500}\PY{p}{)}        \PY{c+c1}{\PYZsh{} dircichlet bc at bot}
        \PY{c+c1}{\PYZsh{} Analytical solution}
        \PY{n}{c} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{a}\PY{o}{*}\PY{n}{pi}\PY{o}{*}\PY{n}{kr}\PY{o}{/}\PY{n}{kz}
        \PY{n}{p\PYZus{}r} \PY{o}{=} \PY{k}{lambda} \PY{n}{z}\PY{p}{:} \PY{n}{toHead}\PY{p}{(} \PY{n}{p\PYZus{}s} \PY{o}{+} \PY{n}{d}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{n}{exp}\PY{p}{(}\PY{n}{sqrt}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{o}{*}\PY{n}{z}\PY{p}{)} \PY{o}{+} \PY{n}{d}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{*}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{sqrt}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{o}{*}\PY{n}{z}\PY{p}{)} \PY{p}{)}
        \PY{n}{za\PYZus{}} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{n}{L}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} Scenario 1}
        \PY{n}{AA} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{sqrt}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{o}{*}\PY{n}{L}\PY{p}{)}\PY{p}{,} \PY{n}{exp}\PY{p}{(}\PY{n}{sqrt}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{o}{*}\PY{n}{L}\PY{p}{)}\PY{p}{]} \PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} dirichlet top \PYZam{} bot}
        \PY{n}{bb} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{p0}\PY{o}{\PYZhy{}}\PY{n}{p\PYZus{}s}\PY{p}{,} \PY{n}{pL}\PY{o}{\PYZhy{}}\PY{n}{p\PYZus{}s}\PY{p}{]}\PY{p}{)} 
        \PY{n}{d} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{solve}\PY{p}{(}\PY{n}{AA}\PY{p}{,} \PY{n}{bb}\PY{p}{)} 
        \PY{n}{pr1} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n}{p\PYZus{}r}\PY{p}{,} \PY{n}{za\PYZus{}}\PY{p}{)}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} Scenario 2}
        \PY{n}{AA} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{sqrt}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{o}{*}\PY{n}{exp}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{sqrt}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{o}{*}\PY{n}{L}\PY{p}{)}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{sqrt}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{o}{*}\PY{n}{exp}\PY{p}{(}\PY{n}{sqrt}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{o}{*}\PY{n}{L}\PY{p}{)}\PY{p}{]} \PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} dirichlet top, neumann bot}
        \PY{n}{bb} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{p0}\PY{o}{\PYZhy{}}\PY{n}{p\PYZus{}s}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{rho}\PY{o}{*}\PY{n}{g}\PY{p}{]}\PY{p}{)} 
        \PY{n}{d} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{solve}\PY{p}{(}\PY{n}{AA}\PY{p}{,} \PY{n}{bb}\PY{p}{)} 
        \PY{n}{pr2} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n}{p\PYZus{}r}\PY{p}{,} \PY{n}{za\PYZus{}}\PY{p}{)}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} The final plot}
        \PY{n}{f}\PY{p}{,} \PY{p}{(}\PY{n}{ax1}\PY{p}{,} \PY{n}{ax2}\PY{p}{)} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{sharey}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
        \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{pr1}\PY{p}{,}\PY{n}{za\PYZus{}}\PY{p}{)}
        \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{h1\PYZus{}}\PY{p}{,}\PY{n}{z\PYZus{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r+}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{pr2}\PY{p}{,}\PY{n}{za\PYZus{}}\PY{p}{)}
        \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{h2\PYZus{}}\PY{p}{,}\PY{n}{z\PYZus{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r+}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Depth (m)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Xylem pressure (cm)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Xylem pressure (cm)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} for automatic evalutation}
        \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{xylem\PYZus{}flux/b1/dumux1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{(}\PY{n}{za\PYZus{}}\PY{p}{,}\PY{n}{pr1}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{delimiter}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{xylem\PYZus{}flux/b1/dumux2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{(}\PY{n}{za\PYZus{}}\PY{p}{,}\PY{n}{pr2}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{delimiter}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Additionally, we conmpare the DuMu\({}^x\) solution for a horizontal
root in Scenario 2 to the analytical solution without gravity:

    \subsection{Benchmark 2}\label{benchmark-2}

We start by creating a DGF file containing the small rootsystem, and
attaching all segment dependent data to the segments.

The root system data of Benchmark 2 is given by

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{nodes} \PY{o}{=} \PY{p}{[} \PY{p}{[}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{2.9}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.00}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.48}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.85}\PY{p}{,}\PY{l+m+mf}{0.48}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.71}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.69}\PY{p}{,}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.90}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{2.58}\PY{p}{,}\PY{l+m+mf}{1.32}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.21}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.48}\PY{p}{,}\PY{l+m+mf}{1.67}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.49}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.38}\PY{p}{,}\PY{l+m+mf}{2.00}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.77}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.24}\PY{p}{,}\PY{l+m+mf}{2.40}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.09}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.08}\PY{p}{,}\PY{l+m+mf}{2.82}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.42}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.93}\PY{p}{,}\PY{l+m+mf}{3.27}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.69}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.96}\PY{p}{,}\PY{l+m+mf}{3.29}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.70}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.97}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.20}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.95}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.43}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.88}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.49}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.65}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{2.81}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.77}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.84}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.06}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.04}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.70}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.31}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.27}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.64}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.54}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.43}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.58}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.84}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.48}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.91}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.94}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.03}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.45}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.75}\PY{p}{,}\PY{l+m+mf}{0.68}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.48}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.52}\PY{p}{,}\PY{l+m+mf}{1.32}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.50}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{2.30}\PY{p}{,}\PY{l+m+mf}{1.94}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.46}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{3.07}\PY{p}{,}\PY{l+m+mf}{2.58}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.41}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{3.88}\PY{p}{,}\PY{l+m+mf}{3.16}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.46}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{4.73}\PY{p}{,}\PY{l+m+mf}{3.69}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.50}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{5.34}\PY{p}{,}\PY{l+m+mf}{4.05}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.53}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.03}\PY{p}{,}\PY{l+m+mf}{0.06}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{4.97}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.73}\PY{p}{,}\PY{l+m+mf}{0.63}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.40}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.46}\PY{p}{,}\PY{l+m+mf}{1.20}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.79}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{2.15}\PY{p}{,}\PY{l+m+mf}{1.80}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.18}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{2.76}\PY{p}{,}\PY{l+m+mf}{2.48}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.59}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.16}\PY{p}{,}\PY{l+m+mf}{3.16}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.21}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.63}\PY{p}{,}\PY{l+m+mf}{3.90}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.64}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.06}\PY{p}{,}\PY{l+m+mf}{0.07}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.42}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.07}\PY{p}{,}\PY{l+m+mf}{1.04}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.61}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.23}\PY{p}{,}\PY{l+m+mf}{2.00}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.82}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.46}\PY{p}{,}\PY{l+m+mf}{2.93}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.11}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.72}\PY{p}{,}\PY{l+m+mf}{3.85}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.40}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{4.77}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.69}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.06}\PY{p}{,}\PY{l+m+mf}{5.11}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.78}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.10}\PY{p}{,}\PY{l+m+mf}{0.08}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{5.96}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.35}\PY{p}{,}\PY{l+m+mf}{0.90}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.31}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.80}\PY{p}{,}\PY{l+m+mf}{1.72}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.65}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.23}\PY{p}{,}\PY{l+m+mf}{2.55}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.01}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.62}\PY{p}{,}\PY{l+m+mf}{3.41}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.34}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.70}\PY{p}{,}\PY{l+m+mf}{3.58}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.41}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.14}\PY{p}{,}\PY{l+m+mf}{0.10}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.46}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.05}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.81}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.83}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.29}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.72}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.18}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.43}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{2.62}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.59}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.50}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{3.12}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.84}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.19}\PY{p}{,}\PY{l+m+mf}{0.12}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.02}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.32}\PY{p}{,}\PY{l+m+mf}{0.98}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.03}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.82}\PY{p}{,}\PY{l+m+mf}{1.84}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.95}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.07}\PY{p}{,}\PY{l+m+mf}{2.23}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{6.88}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.23}\PY{p}{,}\PY{l+m+mf}{0.17}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.56}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{0.68}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.18}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.80}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1.12}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.35}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7.93}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.24}\PY{p}{,}\PY{l+m+mf}{0.21}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{8.14}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.36}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{8.22}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{l+m+mf}{0.24}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{8.69}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.24}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{9.25}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.24}\PY{p}{,}\PY{l+m+mf}{0.26}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{9.71}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.26}\PY{p}{,}\PY{l+m+mf}{0.26}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{10.09}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.28}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{10.57}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.26}\PY{p}{,}\PY{l+m+mf}{0.24}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{11.05}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.26}\PY{p}{,}\PY{l+m+mf}{0.21}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{11.58}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{l+m+mf}{0.19}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{12.06}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{l+m+mf}{0.17}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{12.55}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.23}\PY{p}{,}\PY{l+m+mf}{0.15}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{13.00}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.23}\PY{p}{,}\PY{l+m+mf}{0.12}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{13.46}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.22}\PY{p}{,}\PY{l+m+mf}{0.12}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{13.99}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.21}\PY{p}{,}\PY{l+m+mf}{0.15}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{14.54}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.19}\PY{p}{,}\PY{l+m+mf}{0.20}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{15.07}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.17}\PY{p}{,}\PY{l+m+mf}{0.24}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{15.60}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.17}\PY{p}{,}\PY{l+m+mf}{0.31}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{16.17}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.15}\PY{p}{,}\PY{l+m+mf}{0.36}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{16.64}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.12}\PY{p}{,}\PY{l+m+mf}{0.43}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{17.18}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.11}\PY{p}{,}\PY{l+m+mf}{0.48}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{17.70}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.07}\PY{p}{,}\PY{l+m+mf}{0.52}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{18.23}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.06}\PY{p}{,}\PY{l+m+mf}{0.53}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{18.53}\PY{p}{]} \PY{p}{]}
        \PY{n}{seg} \PY{o}{=} \PY{p}{[} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{21}\PY{p}{,}\PY{l+m+mi}{29}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{29}\PY{p}{,}\PY{l+m+mi}{36}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{43}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{43}\PY{p}{,}\PY{l+m+mi}{49}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{49}\PY{p}{,}\PY{l+m+mi}{54}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{54}\PY{p}{,}\PY{l+m+mi}{58}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{58}\PY{p}{,}\PY{l+m+mi}{61}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{61}\PY{p}{,}\PY{l+m+mi}{63}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{63}\PY{p}{,}\PY{l+m+mi}{64}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{64}\PY{p}{,}\PY{l+m+mi}{65}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{65}\PY{p}{,}\PY{l+m+mi}{66}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{66}\PY{p}{,}\PY{l+m+mi}{67}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{67}\PY{p}{,}\PY{l+m+mi}{68}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{68}\PY{p}{,}\PY{l+m+mi}{69}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{69}\PY{p}{,}\PY{l+m+mi}{70}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{70}\PY{p}{,}\PY{l+m+mi}{71}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{71}\PY{p}{,}\PY{l+m+mi}{72}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{72}\PY{p}{,}\PY{l+m+mi}{73}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{73}\PY{p}{,}\PY{l+m+mi}{74}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{74}\PY{p}{,}\PY{l+m+mi}{75}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{75}\PY{p}{,}\PY{l+m+mi}{76}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{76}\PY{p}{,}\PY{l+m+mi}{77}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{77}\PY{p}{,}\PY{l+m+mi}{78}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{78}\PY{p}{,}\PY{l+m+mi}{79}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{79}\PY{p}{,}\PY{l+m+mi}{80}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{80}\PY{p}{,}\PY{l+m+mi}{81}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{81}\PY{p}{,}\PY{l+m+mi}{82}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{82}\PY{p}{,}\PY{l+m+mi}{83}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{13}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{13}\PY{p}{,}\PY{l+m+mi}{14}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{14}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{16}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{16}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{17}\PY{p}{,}\PY{l+m+mi}{18}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{18}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{19}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{21}\PY{p}{,}\PY{l+m+mi}{22}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{22}\PY{p}{,}\PY{l+m+mi}{23}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{23}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{24}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{26}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{26}\PY{p}{,}\PY{l+m+mi}{27}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{27}\PY{p}{,}\PY{l+m+mi}{28}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{29}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{31}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{31}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{33}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{33}\PY{p}{,}\PY{l+m+mi}{34}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{34}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{36}\PY{p}{,}\PY{l+m+mi}{37}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{37}\PY{p}{,}\PY{l+m+mi}{38}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{38}\PY{p}{,}\PY{l+m+mi}{39}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{39}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{40}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{41}\PY{p}{,}\PY{l+m+mi}{42}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{43}\PY{p}{,}\PY{l+m+mi}{44}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{44}\PY{p}{,}\PY{l+m+mi}{45}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{45}\PY{p}{,}\PY{l+m+mi}{46}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{46}\PY{p}{,}\PY{l+m+mi}{47}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{47}\PY{p}{,}\PY{l+m+mi}{48}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{49}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{51}\PY{p}{,}\PY{l+m+mi}{52}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{52}\PY{p}{,}\PY{l+m+mi}{53}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{54}\PY{p}{,}\PY{l+m+mi}{55}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{55}\PY{p}{,}\PY{l+m+mi}{56}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{56}\PY{p}{,}\PY{l+m+mi}{57}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{58}\PY{p}{,}\PY{l+m+mi}{59}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{59}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{61}\PY{p}{,}\PY{l+m+mi}{62}\PY{p}{]} \PY{p}{]}
        \PY{n}{age} \PY{o}{=} \PY{p}{[} \PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mf}{7.76}\PY{p}{,}\PY{l+m+mf}{7.52}\PY{p}{,}\PY{l+m+mf}{7.29}\PY{p}{,}\PY{l+m+mf}{7.03}\PY{p}{,}\PY{l+m+mf}{6.80}\PY{p}{,}\PY{l+m+mf}{6.53}\PY{p}{,}\PY{l+m+mf}{6.28}\PY{p}{,}\PY{l+m+mf}{6.00}\PY{p}{,}\PY{l+m+mf}{5.73}\PY{p}{,}\PY{l+m+mf}{5.43}\PY{p}{,}\PY{l+m+mf}{5.16}\PY{p}{,}\PY{l+m+mf}{4.87}\PY{p}{,}\PY{l+m+mf}{4.64}\PY{p}{,}\PY{l+m+mf}{4.44}\PY{p}{,}\PY{l+m+mf}{4.20}\PY{p}{,}\PY{l+m+mf}{3.95}\PY{p}{,}\PY{l+m+mf}{3.68}\PY{p}{,}\PY{l+m+mf}{3.43}\PY{p}{,}\PY{l+m+mf}{3.17}\PY{p}{,}\PY{l+m+mf}{2.94}\PY{p}{,}\PY{l+m+mf}{2.70}\PY{p}{,}\PY{l+m+mf}{2.42}\PY{p}{,}\PY{l+m+mf}{2.14}\PY{p}{,}\PY{l+m+mf}{1.85}\PY{p}{,}\PY{l+m+mf}{1.57}\PY{p}{,}\PY{l+m+mf}{1.27}\PY{p}{,}\PY{l+m+mf}{1.02}\PY{p}{,}\PY{l+m+mf}{0.73}\PY{p}{,}\PY{l+m+mf}{0.45}\PY{p}{,}\PY{l+m+mf}{0.16}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{2.29}\PY{p}{,}\PY{l+m+mf}{2.02}\PY{p}{,}\PY{l+m+mf}{1.74}\PY{p}{,}\PY{l+m+mf}{1.43}\PY{p}{,}\PY{l+m+mf}{1.11}\PY{p}{,}\PY{l+m+mf}{0.77}\PY{p}{,}\PY{l+m+mf}{0.41}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{2.04}\PY{p}{,}\PY{l+m+mf}{1.77}\PY{p}{,}\PY{l+m+mf}{1.48}\PY{p}{,}\PY{l+m+mf}{1.18}\PY{p}{,}\PY{l+m+mf}{0.85}\PY{p}{,}\PY{l+m+mf}{0.51}\PY{p}{,}\PY{l+m+mf}{0.14}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{1.78}\PY{p}{,}\PY{l+m+mf}{1.51}\PY{p}{,}\PY{l+m+mf}{1.22}\PY{p}{,}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.60}\PY{p}{,}\PY{l+m+mf}{0.26}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{1.51}\PY{p}{,}\PY{l+m+mf}{1.24}\PY{p}{,}\PY{l+m+mf}{0.96}\PY{p}{,}\PY{l+m+mf}{0.66}\PY{p}{,}\PY{l+m+mf}{0.34}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{1.28}\PY{p}{,}\PY{l+m+mf}{1.01}\PY{p}{,}\PY{l+m+mf}{0.73}\PY{p}{,}\PY{l+m+mf}{0.43}\PY{p}{,}\PY{l+m+mf}{0.12}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{0.97}\PY{p}{,}\PY{l+m+mf}{0.69}\PY{p}{,}\PY{l+m+mf}{0.39}\PY{p}{,}\PY{l+m+mf}{0.07}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{0.72}\PY{p}{,}\PY{l+m+mf}{0.45}\PY{p}{,}\PY{l+m+mf}{0.17}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{0.41}\PY{p}{,}\PY{l+m+mf}{0.14}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{0.13}\PY{p}{,}\PY{l+m+mf}{0.00}\PY{p}{,}\PY{l+m+mf}{0.00} \PY{p}{]}
        \PY{n}{types} \PY{o}{=} \PY{p}{[} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2} \PY{p}{]}
        
        \PY{n}{a\PYZus{}tap} \PY{o}{=} \PY{l+m+mf}{0.2} \PY{c+c1}{\PYZsh{} tap root radius (cm)}
        \PY{n}{a\PYZus{}lateral} \PY{o}{=} \PY{l+m+mf}{0.1} \PY{c+c1}{\PYZsh{} lateral root radius (cm)}
        
        \PY{n}{kz0}\PY{p}{,} \PY{n}{kz1} \PY{o}{=} \PY{l+m+mf}{0.5e\PYZhy{}19}\PY{p}{,} \PY{l+m+mf}{1.e\PYZhy{}18} \PY{c+c1}{\PYZsh{} m\PYZca{}4 / (Pa s)}
        \PY{n}{kr0}\PY{p}{,} \PY{n}{kr1} \PY{o}{=} \PY{l+m+mf}{1.7e\PYZhy{}13}\PY{p}{,} \PY{l+m+mf}{0.2e\PYZhy{}13} \PY{c+c1}{\PYZsh{} m / (Pa s)}
        \PY{n}{kz} \PY{o}{=} \PY{k}{lambda} \PY{n}{age}\PY{p}{:} \PY{l+m+mf}{5.e\PYZhy{}13} \PY{c+c1}{\PYZsh{} kz0*(age\PYZlt{}=3)+kz1*(age\PYZgt{}3)}
        \PY{n}{kr} \PY{o}{=} \PY{k}{lambda} \PY{n}{age}\PY{p}{:} \PY{l+m+mf}{2.e\PYZhy{}9} \PY{c+c1}{\PYZsh{} kr0*(age\PYZlt{}=3)+kr1*(age\PYZgt{}3)}
\end{Verbatim}


    We prepare the parameters that we want to pass via the DGF file and
store it in the file 'rootsystem.dgf'

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{a} \PY{o}{=} \PY{k}{lambda} \PY{n}{t}\PY{p}{:} \PY{l+m+mf}{1.e\PYZhy{}2}\PY{o}{*}\PY{p}{(}\PY{n}{a\PYZus{}tap}\PY{o}{*}\PY{p}{(}\PY{n}{t}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{+}\PY{n}{a\PYZus{}lateral}\PY{o}{*}\PY{p}{(}\PY{n}{t}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} cm\PYZhy{}\PYZgt{}m }
        \PY{n}{a\PYZus{}} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n}{a}\PY{p}{,} \PY{n}{types}\PY{p}{)}\PY{p}{)} 
        \PY{n}{kr\PYZus{}} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n}{kr}\PY{p}{,} \PY{n}{age}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} m / (Pa s)}
        \PY{n}{kz\PYZus{}} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n}{kz}\PY{p}{,} \PY{n}{age}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} m\PYZca{}4 / (Pa s)}
        \PY{n}{nodes} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{nodes}\PY{p}{)}\PY{o}{*}\PY{l+m+mf}{1.e\PYZhy{}2} \PY{c+c1}{\PYZsh{} cm\PYZhy{}\PYZgt{}m, and convert from list to numpy array}
        \PY{n}{seg} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{seg}\PY{p}{)} \PY{c+c1}{\PYZsh{} convert from list to numpy array }
            
        \PY{n}{params} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{(}\PY{n}{a\PYZus{}}\PY{p}{,}\PY{n}{kr\PYZus{}}\PY{p}{,}\PY{n}{kz\PYZus{}}\PY{p}{)}\PY{p}{)}
        \PY{n}{createDGF\PYZus{}1Droots}\PY{p}{(}\PY{n}{path}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{grids/rootsystem.dgf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{nodes}\PY{p}{,} \PY{n}{seg}\PY{p}{,} \PY{n}{params}\PY{p}{)}
\end{Verbatim}


    The rest of the parameter stays in the Dumux input file:

    \begin{verbatim}
[Grid]
File = rootsystem.dgf

[Parameter]
SoilP = -200 # cm pressure head
P0 = -1000 # cm pressure head
Scenario = 2 # 1 or 2  

[Problem]
Name = rootsystem # name passed to the output routines
EnableGravity = 1
\end{verbatim}

    Next we can run the simulation

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{os}\PY{o}{.}\PY{n}{chdir}\PY{p}{(}\PY{n}{path}\PY{p}{)}
        \PY{n}{os}\PY{o}{.}\PY{n}{system}\PY{p}{(} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./rootsystem input/rootsytem.input}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{os}\PY{o}{.}\PY{n}{chdir}\PY{p}{(}\PY{n}{wd}\PY{p}{)}
\end{Verbatim}


    Now we can open the output using

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k}{def} \PY{n+nf}{read3D\PYZus{}vtp\PYZus{}data}\PY{p}{(}\PY{n}{name}\PY{p}{,} \PY{n}{cell} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
             \PY{n}{polydata} \PY{o}{=} \PY{n}{read\PYZus{}polydata}\PY{p}{(}\PY{n}{name}\PY{p}{)}     
             \PY{k}{if} \PY{n}{cell}\PY{p}{:} 
                 \PY{n}{data} \PY{o}{=} \PY{n}{polydata}\PY{o}{.}\PY{n}{GetCellData}\PY{p}{(}\PY{p}{)}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{data} \PY{o}{=} \PY{n}{polydata}\PY{o}{.}\PY{n}{GetPointData}\PY{p}{(}\PY{p}{)}        
             \PY{n}{nocd} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{GetNumberOfArrays}\PY{p}{(}\PY{p}{)} 
             \PY{n}{p} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{GetArray}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{} pressure}
             \PY{n}{noa} \PY{o}{=} \PY{n}{p}\PY{o}{.}\PY{n}{GetNumberOfTuples}\PY{p}{(}\PY{p}{)}
             \PY{n}{p\PYZus{}} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{noa}\PY{p}{,}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{noa}\PY{p}{)}\PY{p}{:}    
                 \PY{n}{d} \PY{o}{=} \PY{n}{p}\PY{o}{.}\PY{n}{GetTuple}\PY{p}{(}\PY{n}{i}\PY{p}{)}
                 \PY{n}{p\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{d}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{Np} \PY{o}{=} \PY{n}{polydata}\PY{o}{.}\PY{n}{GetNumberOfPoints}\PY{p}{(}\PY{p}{)}
             \PY{n}{z\PYZus{}} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{Np}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}   
             \PY{n}{points} \PY{o}{=} \PY{n}{polydata}\PY{o}{.}\PY{n}{GetPoints}\PY{p}{(}\PY{p}{)}    
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{Np}\PY{p}{)}\PY{p}{:}
                 \PY{n}{p} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{p}{)}
                 \PY{n}{points}\PY{o}{.}\PY{n}{GetPoint}\PY{p}{(}\PY{n}{i}\PY{p}{,}\PY{n}{p}\PY{p}{)}
                 \PY{n}{z\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{n}{p}                    
             \PY{k}{return} \PY{n}{p\PYZus{}}\PY{p}{,} \PY{n}{z\PYZus{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{x}\PY{p}{,} \PY{n}{nodes} \PY{o}{=} \PY{n}{read3D\PYZus{}vtp\PYZus{}data}\PY{p}{(}\PY{n}{path}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rootsystem\PYZhy{}00001.vtp}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{x} \PY{o}{=} \PY{n}{toHead}\PY{p}{(}\PY{n}{x}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{xmin} \PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{x}\PY{p}{)}
         \PY{n}{xmax} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n}{x}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{from }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{xmin}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{to}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{xmax}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ cm pressure head}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{fig}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
         \PY{n}{y} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{nodes}\PY{p}{)}\PY{p}{:} 
             \PY{n}{c} \PY{o}{=} \PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{xmin}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{xmax}\PY{o}{\PYZhy{}}\PY{n}{xmin}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{n}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{n}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{n}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{n}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{*}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{color} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{jet}\PY{p}{(}\PY{n}{c}\PY{p}{)}\PY{p}{)}    
             \PY{n}{y}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{n}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cm}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cm}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} for automatic intercomparison}
         \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{xylem\PYZus{}flux/b2/dumux}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{(}\PY{n}{y}\PY{p}{,}\PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{delimiter}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
from  -1000.0 to -580.846075433  cm pressure head

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_45_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    TODO get segment ids from vtk polydata in order to connect points


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
